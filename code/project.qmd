


```{python}
import pandas as pd

df_competition = pd.read_csv("../data/Competition.csv")
df_competitors  = pd.read_csv("../data/Competitors.csv")
df_games        = pd.read_csv("../data/Games.csv")
df_teams        = pd.read_csv("../data/Teams.csv")
df_ends         = pd.read_csv("../data/Ends.csv")
df_stones       = pd.read_csv("../data/Stones.csv")


merged = pd.merge(
    df_stones,
    df_ends,
    on=["CompetitionID","SessionID","GameID","EndID","TeamID"],
    how="left"
)

merged = pd.merge(
    merged,
    df_games,
    on=["CompetitionID","SessionID","GameID"],
    how="left"
)

df = pd.merge(
    merged,
    df_teams[["CompetitionID","TeamID","NOC"]],
    on=["CompetitionID","TeamID"],
    how="left"
)

df.columns = df.columns.str.lower().str.replace('id', '_id')
df.head()
```
```{python}
df.info()
```
```{python}
df.isnull().sum()
```
```{python}
print(df['powerplay'].value_counts())
print(df['timeout'].value_counts())
cols_to_fill = ['powerplay', 'timeout']
df[cols_to_fill] = df[cols_to_fill].fillna(0)
```
```{python}
df = df.dropna(subset=["stone_3_x"])
null_counts = df.isnull().sum()
print(null_counts)
```